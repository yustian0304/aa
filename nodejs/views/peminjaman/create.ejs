<div class="panel panel-default">
    <div class="panel-heading">Panel Heading</div>
	<div class="panel-body">
		<form  action="" method="POST" id="create_anggota" class="form-horizontal" enctype="multipart/form-data">
        	<div class="form-group" style="display: none;">
			    <label class="control-label col-sm-2" for="id_anggota">Id Anggota</label>
			    <div class="col-sm-10">
        		  <input type="text" class="form-control" name="id_anggota" value="" id="id_anggota">
			    </div>
			</div>

			<div class="form-group">
			    <label class="control-label col-sm-2" for="nama_anggota">Nama Anggota</label>
			    <div class="col-sm-10">
        		  <input type="text" class="form-control" name="nama_anggota" value="" id="nama_anggota">
			    </div>
			</div>

			<div class="form-group">
			    <label class="control-label col-sm-2" for="tanggal">Tanggal Pinjam</label>
			    <div class="col-sm-10">
        		  <input type="text" class="form-control" name="tanggal" value="" id="tanggal">
			    </div>
			</div>

			<div class="form-group">
			    <label class="control-label col-sm-2" for="no_faktur">No Faktur</label>
			    <div class="col-sm-10">
        		  <input type="text" class="form-control" name="no_faktur" value="" id="no_faktur">
			    </div>
			</div>

			<div class="form-group">
			    <label class="control-label col-sm-2" for="id_buku">Buku</label>
			    <div class="col-sm-10">
			      <div class="input-group">
        		  		<input type="text" class="form-control" name="id_buku" value="" id="id_buku">
					   	<div class="input-group-btn">
					      <button class="btn btn-default" type="button" data-toggle="modal" data-target="#myModal">
					        <i class="glyphicon glyphicon-search"></i>
					      </button>
					    </div>
				  </div>
			    </div>
			</div>

			<table class="table table-bordered table-hover">
				<thead>
					<th>No</th>
					<th>Judul Buku</th>
					<th>Pengarang</th>
					<th>Penerbit</th>
					<th>jumlah</th>
					<th>aksi</th>
				</thead>
				<tbody class="tmp_buku">
					
				</tbody>
			</table>
	        <div class="modal-footer">
	          <button type="submit" class="btn btn-default">Save</button>
	          <a href="/anggota" type="button" class="btn btn-default">batal</a>
	        </div>
        </form>
	</div>
</div>

<div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Modal Header</h4>
        </div>
        <div class="modal-body">
	          <p>
	          	<table class="table table-bordered table-hover">
					<thead>
						<th>No</th>
						<th>Judul Buku</th>
						<th>aksi <input type="checkbox" name="ck_buku" class="checkbox select_all"</th>
					</thead>
					<tbody class="modal_buku">
						<% data=JSON.parse(result); 
							for(value in data){
						%>
						<tr>
							<td><%= data[value].id %></td>
							<td><%= data[value].judul_buku %></td>
							<td><input type="checkbox" name="ck_buku" class="checkbox select_one"  value="<%= data[value].id %>" json='<%= JSON.stringify(data[value]) %>'></td>
						</tr>
						<% } %>
					</tbody>
				</table>
	          </p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" id="tambah">Save</button>
          <button type="button" class="btn btn-default" data-dismiss="modal">batal</button>
        </div>
      </div>
      
    </div>
</div>
<script type="text/javascript">
$(document).ready(function () {
  $('.select_all').on('click', function () {
    $(this).closest('table').find('tbody :checkbox')
      .prop('checked', this.checked)
      .closest('tr').toggleClass('selected', this.checked);
  });

  $('tbody :checkbox').on('click', function () {
    $(this).closest('tr').toggleClass('selected', this.checked); //Classe de seleção na row
    $(this).closest('table').find('.select_all').prop('checked', ($(this).closest('table').find('tbody :checkbox:checked').length == $(this).closest('table').find('tbody :checkbox').length)); //Tira / coloca a seleção no .select_all
  });

  $(document).on('click','#tambah',function(){
  	// var data=JSON.parse($)
  	// var arr=$('.select_one :checked').val();
  	var myArray=$(".select_one:checked").map(function(){
      return $(this).attr('json');
    }).get();

	// alert(pecah[0]);
	for (var i = 0; i < myArray.length; i++) {
  	var data=JSON.parse(myArray[i]);
  	// alert(data.judul_buku);
  	$('.tmp_buku').append('<tr>'+
  					'<td></td>'+
  					'<td>'+data.judul_buku+'</td>'+
  					'<td>'+data.pengarang+'</td>'+
  					'<td>'+data.penerbit+'</td>'+
  					'<td></td>'+
  					'<td></td>'+
  			 '</tr>');
	}
  });
});  
</script>
